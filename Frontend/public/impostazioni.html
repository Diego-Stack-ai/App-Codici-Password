<!DOCTYPE html>
<html lang="it">

<head>
    <!-- Anti-flicker & Theme Master (V3.9) -->
    <script src="assets/js/theme-init.js"></script>
    <!-- CSP (Content Security Policy) - V3.9 Standard -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self' https://*.firebaseapp.com https://*.googleapis.com; script-src 'self' https://*.firebaseapp.com https://apis.google.com https://www.googletagmanager.com https://www.gstatic.com https://cdnjs.cloudflare.com 'sha256-vvt4KWwuNr51XfE5m+hzeNEGhiOfZzG97ccfqGsPwvE='; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https://*; connect-src 'self' https://*.googleapis.com https://*.firebaseio.com https://www.gstatic.com wss://*.firebaseio.com; frame-src 'self' https://*.firebaseapp.com https://www.gstatic.com;">
    <meta charset="utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Impostazioni - PROTOCOLLO BASE V3.9</title>

    <!-- PWA / Mobile Capable -->
    <link rel="manifest" href="manifest.json?v=3.9.1" />
    <link rel="apple-touch-icon" sizes="192x192" href="./assets/images/app-icon.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">


    <!-- Design System Master (PROTOCOLLO V5.0) -->
    <link rel="stylesheet" href="assets/css/core.css?v=5.0">
    <link rel="stylesheet" href="assets/css/core_fonts.css">
    <link rel="stylesheet" href="assets/css/core_fascie.css">
    <link rel="stylesheet" href="assets/css/core_ui.css?v=5.0">
    <link rel="stylesheet" href="assets/css/moduli.css?v=5.0">
    <link rel="stylesheet" href="assets/css/impostazioni.css?v=5.0">
</head>

<body class="base-bg">
    <script src="assets/js/core.js"></script>
    <script type="module" src="assets/js/ui-core.js"></script>
    <div class="base-container">
        <!-- Ambient Glow -->
        <div class="base-glow"></div>

        <!-- Automated Header -->
        <header id="header-placeholder" class="base-header"></header>
        <!-- Spacer header rimosso -->

        <!-- Main Content -->
        <main class="base-main">
            <div class="page-container pt-header-extra pb-footer-extra">

                <!-- Hero Profile Header (V3.9 Refactored) -->
                <div class="card-hero border-glow hero-card-variant">
                    <!-- Visual Effects (V3.9 Saette) -->
                    <div class="saetta-master"></div>
                    <div class="saetta-drop"></div>

                    <div class="hero-content-layout">
                        <!-- Top Row: Avatar + QR -->
                        <div class="hero-top-row">
                            <div class="hero-avatar-container">
                                <div id="user-avatar-settings" class="hero-avatar bg-cover bg-center"></div>
                            </div>

                            <div id="qrcode-preview" class="qr-preview-box">
                                <div class="qr-lens-icon">
                                    <span class="material-symbols-outlined">zoom_in</span>
                                </div>
                            </div>
                        </div>

                        <!-- Bottom Info: Name + Button -->
                        <div class="hero-info-col">
                            <h1 id="user-name-settings" class="hero-user-name" data-t="loading">Caricamento...</h1>
                            <button id="btn-manage-account" class="btn-manage-account-semantic">
                                <span class="material-symbols-outlined">manage_accounts</span>
                                <span data-t="manage_account_data">Gestisci Account</span>
                            </button>
                        </div>
                    </div>

                    <!-- Hidden QR for data access -->
                    <div id="qrcode-settings" class="hidden"></div>
                </div>

                <!-- Impostazioni Generali -->
                <div class="settings-container">
                    <h3 class="settings-desc" data-t="general_settings">Impostazioni Generali</h3>

                    <!-- Lingua -->
                    <div class="settings-item settings-item-stack" id="btn-toggle-lang">
                        <div class="settings-item-header-row">
                            <div class="settings-icon-box icon-purple">
                                <span class="material-symbols-outlined">translate</span>
                            </div>
                            <div class="settings-item-info">
                                <span class="settings-label" data-t="language_title">Lingua App</span>
                                <span id="current-lang-label" class="settings-desc">Italiano</span>
                            </div>
                            <span id="lang-chevron" class="material-symbols-outlined arrow-icon">expand_more</span>
                        </div>
                    </div>
                    <div id="lang-dropdown" class="settings-dropdown-panel hidden">
                        <button class="settings-dropdown-btn lang-option" data-code="it">
                            <span>üáÆüáπ</span> Italiano
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="en">
                            <span>üá∫üá∏</span> English
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="es">
                            <span>üá™üá∏</span> Espa√±ol
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="fr">
                            <span>üá´üá∑</span> Fran√ßais
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="de">
                            <span>üá©üá™</span> Deutsch
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="zh">
                            <span>üá®üá≥</span> ‰∏≠Êñá
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="hi">
                            <span>üáÆüá≥</span> ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
                        </button>
                        <button class="settings-dropdown-btn lang-option" data-code="pt">
                            <span>üáµüáπ</span> Portugu√™s
                        </button>
                    </div>

                    <!-- Tema -->
                    <div class="settings-item settings-item-stack">
                        <div class="settings-item-header-row">
                            <div class="settings-icon-box icon-blue">
                                <span class="material-symbols-outlined">palette</span>
                            </div>
                            <div class="settings-item-info">
                                <span class="settings-label" data-t="theme_title">Tema Visivo</span>
                                <span class="settings-desc" data-t="theme_desc">Look & Feel</span>
                            </div>
                        </div>
                        <div class="settings-controls-row" id="theme-selector">
                            <button class="timer-btn flex-1 theme-btn" data-theme="light"
                                data-t="theme_light">Chiaro</button>
                            <button class="timer-btn flex-1 theme-btn" data-theme="auto"
                                data-t="theme_auto">Auto</button>
                            <button class="timer-btn flex-1 theme-btn" data-theme="dark"
                                data-t="theme_dark">Scuro</button>
                        </div>
                    </div>

                    <!-- Link Rapidi -->
                    <button class="settings-item group" id="btn-expiry-rules">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-amber">
                                <span class="material-symbols-outlined">calendar_month</span>
                            </div>
                            <span class="settings-label" data-t="expiry_rules_title_page">Regole invio scadenze</span>
                        </div>
                        <span class="material-symbols-outlined text-secondary arrow-icon">chevron_right</span>
                    </button>

                    <button class="settings-item group" id="btn-account-archive">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-purple">
                                <span class="material-symbols-outlined">archive</span>
                            </div>
                            <span class="settings-label" data-t="account_archive">Archivio Account</span>
                        </div>
                        <span class="material-symbols-outlined text-secondary arrow-icon">chevron_right</span>
                    </button>

                    <button class="settings-item group" id="btn-notifications-history">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-blue">
                                <span class="material-symbols-outlined">notifications</span>
                            </div>
                            <span class="settings-label" data-t="notifications_history_title">Storico Notifiche</span>
                        </div>
                        <span class="material-symbols-outlined text-secondary arrow-icon">chevron_right</span>
                    </button>
                </div>

                <!-- Sicurezza e Accesso -->
                <div class="settings-container mt-section">
                    <h3 class="settings-desc" data-t="section_security">Sicurezza e Accesso</h3>

                    <!-- Password -->
                    <button class="settings-item group" id="btn-change-password">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-red">
                                <span class="material-symbols-outlined">lock_reset</span>
                            </div>
                            <div class="settings-item-info">
                                <span class="settings-label" data-t="change_password">Cambio Password</span>
                                <span class="settings-desc" data-t="change_password_desc">Aggiorna le chiavi</span>
                            </div>
                        </div>
                        <span class="material-symbols-outlined text-secondary arrow-icon">chevron_right</span>
                    </button>

                    <!-- 2FA -->
                    <div class="settings-item">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-emerald">
                                <span class="material-symbols-outlined">verified_user</span>
                            </div>
                            <span class="settings-label" data-t="two_factor_auth">2FA</span>
                        </div>
                        <input type="checkbox" id="2fa-toggle" class="settings-toggle">
                    </div>

                    <!-- Biometrico -->
                    <div class="settings-item">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-blue">
                                <span class="material-symbols-outlined">face</span>
                            </div>
                            <span class="settings-label" data-t="face_id">Biometrico</span>
                        </div>
                        <input type="checkbox" id="face-id-toggle" class="settings-toggle">
                    </div>

                    <!-- Blocco Inattivit√† -->
                    <div class="settings-item settings-item-stack">
                        <div class="settings-item-header-row">
                            <div class="settings-icon-box icon-purple">
                                <span class="material-symbols-outlined">timer</span>
                            </div>
                            <div class="settings-item-info">
                                <span class="settings-label" data-t="lock_inactivity">Blocco Inattivit√†</span>
                                <span class="settings-desc" data-t="lock_inactivity_desc">Autolock schermo</span>
                            </div>
                        </div>
                        <div class="settings-controls-row" id="lock-timer-selector">
                            <button class="timer-btn flex-1" data-val="0" data-t="lock_immediately">Subito</button>
                            <button class="timer-btn flex-1" data-val="1">1'</button>
                            <button class="timer-btn flex-1" data-val="3">3'</button>
                            <button class="timer-btn flex-1" data-val="5">5'</button>
                        </div>
                    </div>
                </div>

                <!-- Supporto e Info -->
                <div class="settings-container mt-section">
                    <h3 class="settings-desc" data-t="section_support">Supporto e Info</h3>

                    <!-- App Info -->
                    <button class="settings-item group" id="btn-toggle-app-info">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-blue">
                                <span class="material-symbols-outlined">info</span>
                            </div>
                            <span class="settings-label" data-t="app_info_title">Informazioni App</span>
                        </div>
                        <span id="info-chevron" class="material-symbols-outlined arrow-icon">expand_more</span>
                    </button>
                    <div id="info-app-content" class="settings-dropdown-panel hidden">
                        <div id="info-app-text-placeholder"></div>
                    </div>

                    <!-- Privacy -->
                    <button class="settings-item group" id="btn-privacy">
                        <div class="row-layout">
                            <div class="settings-icon-box icon-emerald">
                                <span class="material-symbols-outlined">shield</span>
                            </div>
                            <span class="settings-label" data-t="privacy_policy_title">Privacy & Dati</span>
                        </div>
                        <span class="material-symbols-outlined text-secondary arrow-icon">chevron_right</span>
                    </button>
                </div>

                <!-- Logout -->
                <div class="logout-btn-container">
                    <button id="logout-btn-settings" class="btn-logout-semantic">
                        <span class="material-symbols-outlined">logout</span>
                        <span class="btn-logout-text" data-t="logout">Esci dall'account</span>
                    </button>
                </div>

            </div>
        </main>

        <!-- QR Zoom Modal (Semantic V3.9) -->
        <div id="qr-zoom-modal" class="zoom-modal hidden">
            <div class="zoom-backdrop"></div>
            <div class="zoom-content">
                <div id="qrcode-zoom" class="zoom-qr-box"></div>
                <button id="btn-close-qr" class="zoom-close-btn">Chiudi</button>
            </div>
        </div>

        <!-- Spacer footer rimosso -->
        <footer id="footer-placeholder" class="base-footer"></footer>
    </div>

    <!-- Scripts -->
    <script type="module" src="assets/js/main.js"></script>
    <script type="module" src="assets/js/modules/settings/impostazioni.js"></script>
</body>

</html>