<!DOCTYPE html>
<html class="dark" lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark only">
    <meta name="theme-color" content="#0a0f1e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no, date=no, address=no, email=no">
    <title>Dati Anagrafici - Privato</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#3b82f6',
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        }
                    }
                }
            }
        }
    </script>

    <!-- QR Code Lib -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        body {
            background-color: #0a0f1e;
            color: #f8fafc;
            overflow-x: hidden;
        }

        .filled {
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        /* 3) FARO ANIMATO (GLASS GLOW) */
        @keyframes glowFloat {

            0%,
            100% {
                opacity: 0.6;
                transform: translateY(0) scale(1) translateX(-50%);
            }

            50% {
                opacity: 0.9;
                transform: translateY(-10px) scale(1.05) translateX(-50%);
            }
        }

        .glass-glow {
            position: absolute;
            top: 0;
            left: 50%;
            width: 150%;
            height: 120%;
            background: radial-gradient(ellipse at 50% 0%,
                    rgba(59, 130, 246, 0.4) 0%,
                    rgba(59, 130, 246, 0.15) 25%,
                    rgba(59, 130, 246, 0.05) 50%,
                    transparent 75%);
            filter: blur(80px);
            z-index: 0;
            pointer-events: none;
            transform: translateX(-50%);
            animation: glowFloat 4s ease-in-out infinite;
        }

        /* 9) BORDER GLOW RIFLETTENTE */
        .border-glow {
            position: relative;
        }

        .border-glow::after {
            content: "";
            position: absolute;
            inset: 0;
            padding: 1px;
            border-radius: inherit;
            background: linear-gradient(to bottom right, rgba(255, 255, 255, 0.2), transparent, rgba(255, 255, 255, 0.05));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
            pointer-events: none;
            z-index: 0;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="tel"],
        input[type="date"],
        textarea {
            background-color: rgba(0, 0, 0, 0.3) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            color: white !important;
            border-radius: 12px !important;
            transition: all 0.3s ease;
        }

        input:focus,
        textarea:focus {
            border-color: #3b82f6 !important;
            box-shadow: 0 0 15px -5px rgba(59, 130, 246, 0.5) !important;
            background-color: rgba(0, 0, 0, 0.4) !important;
            outline: none;
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        /* View mode styles */
        .view-field {
            font-weight: 600;
            color: #f8fafc;
            min-height: 1.25rem;
        }

        .view-label {
            font-size: 9px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding-left: 4px;
            margin-bottom: -2px;
        }

        /* PROTEZIONE REGOLA 5 & 30: NON COPIABILE */
        .no-copy {
            user-select: none !important;
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            pointer-events: none;
        }

        .help-text {
            user-select: none !important;
            -webkit-user-select: none !important;
            pointer-events: auto;
        }

        /* 13) SAETTA (METALLIC SHIMMER) */
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .saetta {
            position: relative;
            overflow: hidden;
        }

        .saetta::before {
            content: "";
            position: absolute;
            inset: 0;
            background: linear-gradient(110deg,
                    transparent 45%,
                    rgba(255, 255, 255, 0.08) 50%,
                    transparent 55%);
            background-size: 200% 100%;
            animation: shimmer 4s infinite linear;
            pointer-events: none;
            z-index: 5;
        }

        /* 16) GLASS FIELD GRADIENTS (METODO TITANIUM) */
        .glass-field {
            position: relative;
            padding: 10px 14px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .glass-field:hover {
            border-color: rgba(255, 255, 255, 0.15);
            transform: translateX(2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Varianti Colore Gradienti (Media = Colore Base) */
        .glass-field-blue {
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.12) 0%, rgba(37, 99, 235, 0.08) 100%);
        }

        .glass-field-blue:hover {
            border-color: rgba(59, 130, 246, 0.4);
        }

        .glass-field-emerald {
            background: linear-gradient(135deg, rgba(52, 211, 153, 0.12) 0%, rgba(5, 150, 105, 0.08) 100%);
        }

        .glass-field-emerald:hover {
            border-color: rgba(16, 185, 129, 0.4);
        }

        .glass-field-amber {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.12) 0%, rgba(217, 119, 6, 0.08) 100%);
        }

        .glass-field-amber:hover {
            border-color: rgba(245, 158, 11, 0.4);
        }

        .glass-field-violet {
            background: linear-gradient(135deg, rgba(167, 139, 250, 0.12) 0%, rgba(124, 58, 237, 0.08) 100%);
        }

        .glass-field-violet:hover {
            border-color: rgba(139, 92, 246, 0.4);
        }

        .glass-field-rose {
            background: linear-gradient(135deg, rgba(251, 113, 133, 0.12) 0%, rgba(225, 29, 72, 0.08) 100%);
        }

        .glass-field-rose:hover {
            border-color: rgba(244, 63, 94, 0.4);
        }

        .glass-field-cyan {
            background: linear-gradient(135deg, rgba(34, 211, 238, 0.12) 0%, rgba(8, 145, 178, 0.08) 100%);
        }

        .glass-field-cyan:hover {
            border-color: rgba(6, 182, 212, 0.4);
        }
    </style>
</head>

<body class="bg-[#0a0f1e] text-white font-display antialiased selection:bg-blue-500/30">
    <!-- 2) Contenitore Principale -->
    <div
        class="relative flex min-h-screen w-full flex-col md:max-w-3xl lg:max-w-5xl mx-auto shadow-2xl overflow-hidden bg-gradient-to-l from-[#030712] to-[#162e6e]">

        <!-- 3) Faro -->
        <div class="glass-glow"></div>

        <!-- 4) Header Fusion -->
        <header
            class="fixed top-0 left-0 right-0 mx-auto w-full md:max-w-3xl lg:max-w-5xl z-50 bg-gradient-to-b from-[#0a0f1e] to-transparent backdrop-blur-md">
            <div class="flex items-center px-4 h-16 gap-4">
                <a href="home_page.html" id="action-back-btn"
                    class="group relative z-10 flex size-10 shrink-0 items-center justify-center rounded-xl bg-white/5 hover:bg-white/10 border-glow transition-all duration-300 active:scale-95 text-white">
                    <span
                        class="material-symbols-outlined text-[24px] group-hover:-translate-x-0.5 transition-transform">arrow_back</span>
                </a>

                <h1 id="user-name"
                    class="relative z-10 text-lg font-bold leading-tight tracking-tight text-center flex-1 text-white uppercase opacity-90 truncate">
                    ...
                </h1>

                <!-- Actions Group -->
                <div class="relative z-10 flex items-center gap-2">
                    <button id="action-edit-btn"
                        class="flex size-10 shrink-0 items-center justify-center rounded-xl bg-white/5 hover:bg-white/10 border-glow transition-all duration-300 active:scale-95 text-white"
                        title="Modifica">
                        <span class="material-symbols-outlined text-[22px]">edit</span>
                    </button>
                    <button id="action-cancel-btn"
                        class="hidden flex size-10 shrink-0 items-center justify-center rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 hover:bg-red-500/20 transition-all active:scale-95"
                        title="Annulla">
                        <span class="material-symbols-outlined text-[22px]">close</span>
                    </button>
                    <button id="action-save-btn"
                        class="hidden flex size-10 shrink-0 items-center justify-center rounded-xl bg-green-500/10 border border-green-500/20 text-green-400 hover:bg-green-500/20 transition-all active:scale-95"
                        title="Salva">
                        <span class="material-symbols-outlined text-[22px] font-bold">check</span>
                    </button>
                    <a href="home_page.html"
                        class="flex size-10 shrink-0 items-center justify-center rounded-xl bg-white/5 hover:bg-white/10 border-glow transition-all duration-300 active:scale-95 text-white">
                        <span class="material-symbols-outlined text-[22px]">home</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Header Spacer -->
        <div class="h-16 w-full shrink-0"></div>



        <!-- Main Content -->
        <main class="titanium-main">

            <!-- Avatar & QR Section -->
            <div class="flex flex-col items-center pt-8 pb-4 px-4 gap-6">
                <div class="flex items-center justify-center gap-8 w-full">

                    <!-- Avatar Upload -->
                    <div class="relative group cursor-pointer"
                        onclick="document.getElementById('avatar-input').click()">
                        <div class="w-32 h-32 rounded-full border-2 border-white/10 p-1 bg-white/5 shadow-2xl relative">
                            <img id="user-avatar" alt="User Avatar"
                                class="w-full h-full rounded-full object-cover shadow-inner"
                                src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2364748b'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E" />
                            <div
                                class="absolute inset-0 bg-black/40 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <span class="material-symbols-outlined text-white text-[28px]">photo_camera</span>
                            </div>
                        </div>
                        <!-- Loading Spinner -->
                        <div id="avatar-loading"
                            class="absolute inset-0 flex items-center justify-center bg-black/40 rounded-full hidden">
                            <span
                                class="material-symbols-outlined animate-spin text-blue-400 text-2xl">progress_activity</span>
                        </div>
                        <input type="file" id="avatar-input" accept="image/*" class="hidden" />
                    </div>

                    <!-- QR Code -->
                    <div class="flex flex-col items-center gap-2">
                        <div class="relative group">
                            <div id="qrcode-container"
                                class="w-28 h-28 bg-white p-2.5 rounded-2xl shadow-2xl flex items-center justify-center overflow-hidden border border-white/10">
                            </div>
                            <button onclick="openQRZoom()"
                                class="absolute -bottom-1 -right-1 w-8 h-8 rounded-xl bg-blue-600 text-white shadow-lg flex items-center justify-center hover:bg-blue-500 transition-all active:scale-95 z-10 ring-4 ring-[#0a0f1e]">
                                <span class="material-symbols-outlined text-[18px]">zoom_in</span>
                            </button>
                        </div>
                        <span class="text-[10px] font-bold text-gray-500 uppercase tracking-widest">Digital Card</span>
                    </div>
                </div>
            </div>

            <!-- Profile Content -->
            <div id="full-profile-container" class="flex flex-col gap-4 p-4">

                <!-- SECTION 1: DATI PERSONALI -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-blue-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <button type="button" onclick="toggleSection('dati-personali-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 text-left hover:bg-white/5 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-blue-500">person</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Dati Personali</h3>
                            <span id="count-dati-personali"
                                class="hidden px-2 py-0.5 rounded-full text-[10px] font-bold bg-blue-500/10 text-blue-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[12px]">attachment</span>
                                <span class="count-val">0</span>
                            </span>
                        </div>
                        <span id="arrow-dati-personali-wrapper"
                            class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                    </button>

                    <div id="dati-personali-wrapper"
                        class="hidden relative z-20 border-t border-white/5 p-4 space-y-4 bg-black/40">
                        <div class="flex justify-end pr-1">
                            <button onclick="copyPersonalData()"
                                class="text-blue-400 text-[10px] font-bold uppercase tracking-wider hover:text-blue-300 flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-blue-500/5 saetta border-glow transition-all active:scale-95">
                                <span class="material-symbols-outlined text-sm">content_copy</span> Copia tutto
                            </button>
                        </div>

                        <div class="bg-blue-500/5 border border-white/5 rounded-2xl p-5 shadow-sm">
                            <div class="grid grid-cols-2 gap-4">
                                <!-- Nome -->
                                <div class="flex flex-col gap-1.5">
                                    <div class="flex justify-between items-center pr-1">
                                        <label class="view-label text-blue-400">Nome</label>
                                        <label
                                            class="qr-check hidden flex items-center gap-1 opacity-70 hover:opacity-100 cursor-pointer">
                                            <span class="text-[8px] font-bold text-gray-500">QR</span>
                                            <input type="checkbox" data-qr-field="nome"
                                                class="checkbox-qr w-3 h-3 rounded text-blue-500">
                                        </label>
                                    </div>
                                    <div class="glass-field glass-field-blue group/field">
                                        <div id="nome-view" class="view-field truncate flex-1 font-semibold text-sm">-
                                        </div>
                                        <button
                                            class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                            data-copy-target="nome-view">
                                            <span
                                                class="material-symbols-outlined text-[17px] text-blue-400">content_copy</span>
                                        </button>
                                    </div>
                                    <input type="text" id="nome-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                        placeholder="Nome">
                                </div>

                                <!-- Cognome -->
                                <div class="flex flex-col gap-1.5">
                                    <div class="flex justify-between items-center pr-1">
                                        <label class="view-label text-blue-400">Cognome</label>
                                        <label
                                            class="qr-check hidden flex items-center gap-1 opacity-70 hover:opacity-100 cursor-pointer">
                                            <span class="text-[8px] font-bold text-gray-500">QR</span>
                                            <input type="checkbox" data-qr-field="cognome"
                                                class="checkbox-qr w-3 h-3 rounded text-blue-500">
                                        </label>
                                    </div>
                                    <div class="glass-field glass-field-blue group/field">
                                        <div id="cognome-view" class="view-field truncate flex-1 font-semibold text-sm">
                                            -</div>
                                        <button
                                            class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                            data-copy-target="cognome-view">
                                            <span
                                                class="material-symbols-outlined text-[17px] text-blue-400">content_copy</span>
                                        </button>
                                    </div>
                                    <input type="text" id="cognome-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                        placeholder="Cognome">
                                </div>

                                <!-- Codice Fiscale -->
                                <div class="col-span-2 flex flex-col gap-1.5">
                                    <div class="flex justify-between items-center pr-1">
                                        <label class="view-label text-blue-400">Codice Fiscale</label>
                                        <label
                                            class="qr-check hidden flex items-center gap-1 opacity-70 hover:opacity-100 cursor-pointer">
                                            <span class="text-[8px] font-bold text-gray-400">QR</span>
                                            <input type="checkbox" data-qr-field="cf"
                                                class="checkbox-qr w-3 h-3 rounded text-blue-500">
                                        </label>
                                    </div>
                                    <div class="glass-field glass-field-blue group/field">
                                        <div id="cf-view"
                                            class="view-field font-mono uppercase tracking-widest text-blue-300 flex-1 text-sm">
                                            -</div>
                                        <button
                                            class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                            data-copy-target="cf-view">
                                            <span
                                                class="material-symbols-outlined text-[17px] text-blue-400">content_copy</span>
                                        </button>
                                    </div>
                                    <input type="text" id="cf-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm font-mono uppercase"
                                        placeholder="CODICE FISCALE">
                                </div>

                                <!-- Birth Date -->
                                <div class="flex flex-col gap-1.5">
                                    <label class="view-label text-blue-400">Nato il</label>
                                    <div class="glass-field glass-field-blue group/field">
                                        <div id="birth_date-view" class="view-field flex-1 font-semibold text-sm">-
                                        </div>
                                        <button
                                            class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                            data-copy-target="birth_date-view">
                                            <span
                                                class="material-symbols-outlined text-[17px] text-blue-400">content_copy</span>
                                        </button>
                                    </div>
                                    <input type="date" id="birth_date-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm">
                                </div>

                                <!-- Birth Place -->
                                <div class="flex flex-col gap-1.5">
                                    <label class="view-label text-blue-400">A</label>
                                    <div class="glass-field glass-field-blue group/field">
                                        <div id="birth_place-view"
                                            class="view-field truncate flex-1 font-semibold text-sm">-</div>
                                        <button
                                            class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                            data-copy-target="birth_place-view">
                                            <span
                                                class="material-symbols-outlined text-[17px] text-blue-400">content_copy</span>
                                        </button>
                                    </div>
                                    <input type="text" id="birth_place-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                        placeholder="Luogo">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 2: RESIDENZA -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-emerald-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <button type="button" onclick="toggleSection('residenza-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 text-left hover:bg-white/5 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-emerald-500">home</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Residenza</h3>
                            <span id="count-residenza"
                                class="hidden px-2 py-0.5 rounded-full text-[10px] font-bold bg-emerald-500/10 text-emerald-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[12px]">attachment</span>
                                <span class="count-val">0</span>
                            </span>
                        </div>
                        <span id="arrow-residenza-wrapper"
                            class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                    </button>

                    <div id="residenza-wrapper"
                        class="hidden relative z-20 border-t border-white/5 p-4 space-y-4 bg-black/40">
                        <div class="flex justify-end pr-1">
                            <button onclick="copyResidence()"
                                class="text-emerald-400 text-[10px] font-bold uppercase tracking-wider hover:text-emerald-300 flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-emerald-500/5 saetta border-glow transition-all active:scale-95">
                                <span class="material-symbols-outlined text-sm">content_copy</span> Copia tutto
                            </button>
                        </div>

                        <div class="bg-emerald-500/5 border border-white/5 rounded-2xl p-5 shadow-sm space-y-4">
                            <!-- Address -->
                            <div class="col-span-2 flex flex-col gap-1.5">
                                <label class="view-label text-emerald-400">Indirizzo</label>
                                <div class="glass-field glass-field-emerald group/field">
                                    <div id="residence_address-view" class="view-field flex-1 font-semibold text-sm">-
                                    </div>
                                    <button
                                        class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                        data-copy-target="residence_address-view">
                                        <span
                                            class="material-symbols-outlined text-[17px] text-emerald-400">content_copy</span>
                                    </button>
                                </div>
                                <input type="text" id="residence_address-edit"
                                    class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                    placeholder="Via/Piazza">
                            </div>

                            <div class="grid grid-cols-3 gap-4">
                                <!-- Civico -->
                                <div class="flex flex-col gap-1.5 text-center">
                                    <label class="view-label text-emerald-400 block w-full">Civico</label>
                                    <div class="glass-field glass-field-emerald justify-center h-11 px-2">
                                        <div id="residence_civic-view" class="view-field truncate font-bold text-sm">-
                                        </div>
                                    </div>
                                    <input type="text" id="residence_civic-edit"
                                        class="edit-container hidden w-full h-11 px-2 rounded-xl text-sm text-center bg-black/20 border-white/10"
                                        placeholder="N.">
                                </div>

                                <!-- CAP -->
                                <div class="flex flex-col gap-1.5 text-center">
                                    <label class="view-label text-emerald-400 block w-full">CAP</label>
                                    <div class="glass-field glass-field-emerald justify-center h-11 px-2">
                                        <div id="residence_cap-view" class="view-field truncate font-bold text-sm">-
                                        </div>
                                    </div>
                                    <input type="text" id="residence_cap-edit"
                                        class="edit-container hidden w-full h-11 px-2 rounded-xl text-sm text-center bg-black/20 border-white/10"
                                        placeholder="CAP">
                                </div>

                                <!-- PV -->
                                <div class="flex flex-col gap-1.5 text-center">
                                    <label class="view-label text-emerald-400 block w-full">Prov</label>
                                    <div class="glass-field glass-field-emerald justify-center h-11 px-2">
                                        <div id="residence_province-view" class="view-field truncate font-bold text-sm">
                                            -
                                        </div>
                                    </div>
                                    <input type="text" id="residence_province-edit"
                                        class="edit-container hidden w-full h-11 px-2 rounded-xl text-sm text-center uppercase bg-black/20 border-white/10"
                                        placeholder="PV" maxlength="2">
                                </div>
                            </div>

                            <!-- City -->
                            <div class="flex flex-col gap-1.5">
                                <label class="view-label text-emerald-400">Città</label>
                                <div class="glass-field glass-field-emerald group/field">
                                    <div id="residence_city-view" class="view-field flex-1 font-semibold text-sm">-
                                    </div>
                                    <button
                                        class="copy-button opacity-0 group-hover/field:opacity-100 transition-opacity"
                                        data-copy-target="residence_city-view">
                                        <span
                                            class="material-symbols-outlined text-[17px] text-emerald-400">content_copy</span>
                                    </button>
                                </div>
                                <input type="text" id="residence_city-edit"
                                    class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm bg-black/20 border-white/10"
                                    placeholder="Città">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 3: UTENZE -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-amber-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <div onclick="toggleSection('utenze-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors cursor-pointer">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-amber-500">bolt</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Utenze</h3>
                            <span id="count-utenze"
                                class="hidden px-2 py-0.5 rounded-full text-[10px] font-bold bg-amber-500/10 text-amber-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[12px]">receipt_long</span>
                                <span class="count-val">0</span>
                            </span>
                        </div>
                        <div class="flex items-center gap-3">
                            <button type="button" id="add-utenza-btn" onclick="event.stopPropagation();"
                                class="hidden text-amber-400 text-[10px] bg-amber-500/5 px-2 py-1 rounded-lg saetta font-bold uppercase tracking-wider hover:text-amber-300 flex items-center gap-1 transition-colors">
                                <span class="material-symbols-outlined text-sm">add</span> Aggiungi
                            </button>
                            <span id="arrow-utenze-wrapper"
                                class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                        </div>
                    </div>

                    <div id="utenze-wrapper" class="hidden relative z-20 border-t border-white/5 p-4 bg-black/40">
                        <div id="utenze-view-container" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Populated by JS -->
                        </div>
                        <div id="utenze-edit-container" class="hidden flex flex-col gap-4">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- SECTION 4: DOCUMENTI -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-violet-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <div onclick="toggleSection('documenti-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors cursor-pointer">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-violet-500">folder_shared</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Documenti</h3>
                            <span id="count-documenti"
                                class="hidden px-2 py-0.5 rounded-full text-[10px] font-bold bg-violet-500/10 text-violet-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[12px]">badge</span>
                                <span class="count-val">0</span>
                            </span>
                        </div>
                        <div class="flex items-center gap-3">
                            <button type="button" id="add-documento-btn" onclick="event.stopPropagation();"
                                class="hidden text-violet-400 text-[10px] bg-violet-500/5 px-2 py-1 rounded-lg saetta font-bold uppercase tracking-wider hover:text-violet-300 flex items-center gap-1 transition-colors">
                                <span class="material-symbols-outlined text-sm">add</span> Aggiungi
                            </button>
                            <span id="arrow-documenti-wrapper"
                                class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                        </div>
                    </div>

                    <div id="documenti-wrapper" class="hidden relative z-20 border-t border-white/5 p-4 bg-black/40">
                        <div id="documenti-view-container" class="space-y-4">
                            <!-- Populated by JS -->
                        </div>
                        <div id="documenti-edit-container" class="hidden flex flex-col gap-4">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- SECTION 5: CONTATTI -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-rose-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <button type="button" onclick="toggleSection('contatti-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 text-left hover:bg-white/5 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-rose-500">call</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Contatti</h3>
                            <span id="count-contatti"
                                class="hidden px-2 py-0.5 rounded-full text-[10px] font-bold bg-rose-500/10 text-rose-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[12px]">call</span>
                                <span class="count-val">0</span>
                            </span>
                        </div>
                        <span id="arrow-contatti-wrapper"
                            class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                    </button>

                    <div id="contatti-wrapper"
                        class="hidden relative z-20 border-t border-white/5 p-4 space-y-6 bg-black/40">
                        <div class="bg-rose-500/5 border border-white/5 rounded-2xl p-5 shadow-sm">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Cellulare -->
                                <div class="flex flex-col gap-1.5">
                                    <div class="flex justify-between items-center pr-1">
                                        <label class="view-label text-rose-400">Cellulare Personale</label>
                                        <label
                                            class="qr-check hidden flex items-center gap-1 opacity-70 hover:opacity-100 cursor-pointer">
                                            <span class="text-[8px] font-bold text-gray-500">QR</span>
                                            <input type="checkbox" data-qr-field="mobile_private"
                                                class="checkbox-qr w-3 h-3 rounded text-blue-500">
                                        </label>
                                    </div>
                                    <div class="glass-field glass-field-rose group/field">
                                        <div id="mobile_private-view"
                                            class="view-field flex-1 truncate font-semibold text-sm">-</div>
                                        <div
                                            class="flex items-center gap-1 shrink-0 opacity-0 group-hover/field:opacity-100 transition-opacity">
                                            <button
                                                class="call-button w-8 h-8 flex items-center justify-center text-rose-400 hover:bg-rose-500/10 rounded-lg transition-colors"
                                                data-call-source="mobile_private-view">
                                                <span class="material-symbols-outlined text-[20px]">call</span>
                                            </button>
                                            <button
                                                class="copy-button w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white rounded-lg transition-colors"
                                                data-copy-target="mobile_private-view">
                                                <span class="material-symbols-outlined text-[17px]">content_copy</span>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="tel" id="mobile_private-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                        placeholder="Cellulare">
                                </div>

                                <!-- Telefono Fisso -->
                                <div class="flex flex-col gap-1.5">
                                    <div class="flex justify-between items-center pr-1">
                                        <label class="view-label text-rose-400">Telefono Fisso</label>
                                        <label
                                            class="qr-check hidden flex items-center gap-1 opacity-70 hover:opacity-100 cursor-pointer">
                                            <span class="text-[8px] font-bold text-gray-500">QR</span>
                                            <input type="checkbox" data-qr-field="phone_private"
                                                class="checkbox-qr w-3 h-3 rounded text-blue-500">
                                        </label>
                                    </div>
                                    <div class="glass-field glass-field-rose group/field">
                                        <div id="phone_private-view"
                                            class="view-field flex-1 truncate font-semibold text-sm">-</div>
                                        <div
                                            class="flex items-center gap-1 shrink-0 opacity-0 group-hover/field:opacity-100 transition-opacity">
                                            <button
                                                class="call-button w-8 h-8 flex items-center justify-center text-rose-400 hover:bg-rose-500/10 rounded-lg transition-colors"
                                                data-call-source="phone_private-view">
                                                <span class="material-symbols-outlined text-[20px]">call</span>
                                            </button>
                                            <button
                                                class="copy-button w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white rounded-lg transition-colors"
                                                data-copy-target="phone_private-view">
                                                <span class="material-symbols-outlined text-[17px]">content_copy</span>
                                            </button>
                                        </div>
                                    </div>
                                    <input type="tel" id="phone_private-edit"
                                        class="edit-container hidden w-full h-11 px-4 rounded-xl text-sm"
                                        placeholder="Telefono Fisso">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECTION 6: EMAIL PERSONALI -->
                <div
                    class="group relative border-glow saetta rounded-2xl bg-[#1e293b]/80 backdrop-blur-md overflow-hidden shadow-lg transition-all duration-300 hover:-translate-y-1 active:scale-[0.98] border border-white/10 hover:border-cyan-500/30">

                    <!-- 10) Glow Overlay Internal -->
                    <div
                        class="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 pointer-events-none z-10">
                    </div>

                    <div onclick="toggleSection('emails-wrapper')"
                        class="relative z-20 w-full flex items-center justify-between p-4 hover:bg-white/5 transition-colors cursor-pointer">
                        <div class="flex items-center gap-3">
                            <span class="material-symbols-outlined text-cyan-500">mail</span>
                            <h3 class="text-white text-sm font-bold uppercase tracking-wider">Email Personali</h3>
                        </div>
                        <div class="flex items-center gap-3">
                            <button type="button" id="add-email-btn" onclick="event.stopPropagation();"
                                class="hidden text-cyan-400 text-[10px] bg-cyan-500/5 px-2 py-1 rounded-lg saetta font-bold uppercase tracking-wider hover:text-cyan-300 flex items-center gap-1 transition-colors">
                                <span class="material-symbols-outlined text-sm">add</span> Aggiungi
                            </button>
                            <span id="arrow-emails-wrapper"
                                class="material-symbols-outlined text-gray-500 transition-transform">expand_more</span>
                        </div>
                    </div>

                    <div id="emails-wrapper" class="hidden relative z-20 border-t border-white/5 p-4 bg-black/40">
                        <div id="email-view-container" class="space-y-3">
                            <!-- Populated by JS -->
                        </div>
                        <div id="email-edit-container" class="hidden space-y-4">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- SECTION 7: NOTE (Deep Box Style) -->
                <!-- SECTION 7: NOTE (Appunti Style) -->
                <div class="pt-4 pb-8">
                    <div class="flex items-center gap-2 px-1 mb-2">
                        <span class="material-symbols-outlined text-yellow-500 text-[20px] filled">edit_note</span>
                        <label class="view-label text-yellow-500">Note Anagrafica</label>
                        <span id="count-note"
                            class="hidden px-2 py-0.5 rounded-full bg-yellow-500/10 text-yellow-400 text-[9px]">0</span>
                    </div>
                    <div
                        class="bg-black/30 border border-white/10 rounded-2xl p-5 shadow-inner relative group transition-all duration-300 hover:border-yellow-500/30">
                        <div id="note-view"
                            class="text-sm text-gray-300 leading-relaxed whitespace-pre-wrap min-h-[4rem] text-justify">
                            -
                        </div>
                        <textarea id="note-edit"
                            class="edit-container hidden w-full h-40 p-0 bg-transparent border-none text-sm resize-none text-white placeholder:text-gray-600 focus:ring-0"
                            placeholder="Aggiungi qui note o dettagli anagrafici..."></textarea>

                        <!-- Pulsante Salva Interno (Visibile solo in edit) -->
                        <div id="note-save-container" class="hidden flex justify-end mt-4 pt-3 border-t border-white/5">
                            <button onclick="document.getElementById('action-save-btn').click()"
                                class="text-[10px] font-bold text-yellow-500 hover:text-yellow-400 flex items-center gap-1.5 px-3 py-1.5 rounded-lg bg-yellow-500/5 saetta transition-colors">
                                <span class="material-symbols-outlined text-sm">save</span> SALVA NOTE
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 5) Aiuto / Descrizione Pagina (Deep Box Style) -->
                <div class="help-text no-copy pt-4 pb-8 px-0.5">
                    <div class="flex items-center gap-2 px-1 mb-2 text-blue-400">
                        <span class="material-symbols-outlined text-[20px] filled">info</span>
                        <h3 class="text-[10px] font-bold uppercase tracking-widest">
                            Informazioni Pagina
                        </h3>
                    </div>
                    <div
                        class="bg-black/30 border border-white/10 rounded-2xl p-5 shadow-inner relative group transition-all duration-300 hover:border-blue-500/30 text-justify">
                        <p class="text-sm text-gray-400 leading-relaxed">
                            Gestisci qui i tuoi dati personali, documenti e contatti. Clicca sull'icona della matita per
                            entrare in modalità modifica o sul tasto copia per prelevare velocemente i dati.
                        </p>
                    </div>
                </div>

            </div>
        </main>

        <!-- 5) Footer Fusion -->
        <footer
            class="fixed bottom-0 left-0 right-0 mx-auto w-full md:max-w-3xl lg:max-w-5xl h-20 bg-gradient-to-t from-[#0a0f1e] to-transparent backdrop-blur-sm pointer-events-none z-40">
        </footer>
    </div>

    <!-- UI Helper Scripts -->
    <script>
        function toggleSection(id) {
            const el = document.getElementById(id);
            const arrow = document.getElementById('arrow-' + id);
            if (el.classList.contains('hidden')) {
                el.classList.remove('hidden');
                if (arrow) arrow.style.transform = 'rotate(180deg)';
            } else {
                el.classList.add('hidden');
                if (arrow) arrow.style.transform = 'rotate(0deg)';
            }
        }

        function togglePasswordVisibility(id) {
            const input = document.getElementById(id);
            if (input.type === 'password') input.type = 'text';
            else input.type = 'password';
        }
    </script>

    <!-- Main Logic -->
    <script src="assets/js/dati_anagrafici_privato.js" type="module"></script>
</body>

</html>